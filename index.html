<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MyBrowser Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f3f4f6; /* gray-100 */
            --card-bg-color: #ffffff; /* white */
            --text-color: #111827; /* gray-900 */
            --text-secondary-color: #6b7280; /* gray-500 */
            --accent-color: #3b82f6; /* blue-500 */
            --border-color: #e5e7eb; /* gray-200 */
        }

        html.dark {
            --bg-color: #111827; /* gray-900 */
            --card-bg-color: #1f2937; /* gray-800 */
            --text-color: #f9fafb; /* gray-50 */
            --text-secondary-color: #9ca3af; /* gray-400 */
            --accent-color: #60a5fa; /* blue-400 */
            --border-color: #374151; /* gray-700 */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overscroll-behavior-y: contain;
        }
        
        /* New layout for vertical centering */
        .center-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding-bottom: 40%; /* Pushes content up from the absolute center */
        }

        /* Transitions for smooth theme and layout changes */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

    </style>
</head>
<body class="overflow-x-hidden">

    <div class="center-container">
        <!-- Search Bar -->
        <header class="p-4 w-full max-w-md">
             <form id="search-form" class="flex items-center w-full bg-[var(--card-bg-color)] rounded-full shadow-sm border border-[var(--border-color)] px-4 py-2.5">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-[var(--text-secondary-color)]"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input id="search-input" type="text" placeholder="Search Google or type URL" class="w-full bg-transparent text-[var(--text-color)] placeholder-[var(--text-secondary-color)] focus:outline-none ml-3 mr-2">
                <button type="submit" class="hidden"></button>
            </form>
        </header>
    
        <!-- Quick Links -->
        <main class="px-4 mt-8 w-full max-w-md">
            <section id="quick-links">
                <div id="quick-links-grid" class="grid grid-cols-4 gap-4 text-center">
                    <!-- Links will be dynamically inserted here -->
                </div>
            </section>
        </main>
    </div>
    
    <!-- Custom Context Menu for Long Press (Hidden) -->
    <div id="contextMenu" class="fixed bg-[var(--card-bg-color)] border border-[var(--border-color)] rounded-xl shadow-lg p-2 text-sm z-50 hidden">
        <a href="#" id="context-edit" class="block px-4 py-2 hover:bg-[var(--bg-color)] rounded-md">Edit link</a>
        <a href="#" id="context-remove" class="block px-4 py-2 text-red-500 hover:bg-[var(--bg-color)] rounded-md">Remove</a>
    </div>

    <!-- Edit/Add Link Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-[var(--card-bg-color)] rounded-2xl p-6 w-full max-w-sm shadow-xl">
            <h2 id="modal-title" class="text-lg font-bold mb-4">Edit Link</h2>
            <form id="edit-form">
                <input type="hidden" id="edit-index">
                <div class="space-y-4">
                    <div>
                        <label for="edit-name" class="text-sm font-medium text-[var(--text-secondary-color)]">Name</label>
                        <input type="text" id="edit-name" required class="mt-1 w-full bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]">
                    </div>
                    <div>
                        <label for="edit-url" class="text-sm font-medium text-[var(--text-secondary-color)]">URL</label>
                        <input type="url" id="edit-url" required placeholder="https://example.com" class="mt-1 w-full bg-[var(--bg-color)] border border-[var(--border-color)] rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" id="cancel-edit" class="px-4 py-2 rounded-lg text-sm font-semibold bg-[var(--bg-color)] hover:opacity-80">Cancel</button>
                    <button type="submit" class="px-4 py-2 rounded-lg text-sm font-semibold bg-[var(--accent-color)] text-white hover:opacity-80">Save</button>
                </div>
            </form>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- THEME MANAGEMENT ---
            const themeManager = {
                init() {
                    const savedTheme = localStorage.getItem('theme');
                    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                }
            };
            themeManager.init();

            // --- DATA MANAGEMENT ---
            let quickLinksData = [];
            const defaultLinks = [
                { name: 'Google', url: 'https://google.com', icon: 'G', color: 'bg-blue-500' },
                { name: 'YouTube', url: 'https://youtube.com', icon: 'YT', color: 'bg-red-500' },
                { name: 'Email', url: 'https://mail.google.com', icon: 'M', color: 'bg-green-500' },
                { name: 'GitHub', url: 'https://github.com', icon: 'GH', color: 'bg-gray-700' },
                { name: 'Twitter', url: 'https://twitter.com', icon: 'X', color: 'bg-black' },
                { name: 'Maps', url: 'https://maps.google.com', icon: 'M', color: 'bg-orange-500' },
                { name: 'Photos', url: 'https://photos.google.com', icon: 'P', color: 'bg-yellow-500' },
            ];

            function loadQuickLinks() {
                const storedLinks = localStorage.getItem('quickLinks');
                quickLinksData = storedLinks ? JSON.parse(storedLinks) : defaultLinks;
                renderQuickLinks();
            }

            function saveQuickLinks() {
                localStorage.setItem('quickLinks', JSON.stringify(quickLinksData));
            }

            // --- ELEMENTS ---
            const quickLinksGrid = document.getElementById('quick-links-grid');
            const contextMenu = document.getElementById('contextMenu');
            const editModal = document.getElementById('editModal');
            const editForm = document.getElementById('edit-form');
            const searchForm = document.getElementById('search-form');
            const searchInput = document.getElementById('search-input');
            let activeLinkIndex = null;

            // --- RENDER FUNCTION ---
            function renderQuickLinks() {
                quickLinksGrid.innerHTML = ''; // Clear existing links
                quickLinksData.forEach((link, index) => {
                    const linkEl = document.createElement('a');
                    linkEl.href = link.url;
                    linkEl.className = 'flex flex-col items-center space-y-2 quick-link-item';
                    linkEl.dataset.index = index;
                    linkEl.innerHTML = `
                        <div class="w-14 h-14 ${link.color} rounded-2xl flex items-center justify-center text-white font-bold text-lg">
                            ${link.icon}
                        </div>
                        <span class="text-xs text-[var(--text-secondary-color)] truncate w-14">${link.name}</span>
                    `;
                    quickLinksGrid.appendChild(linkEl);
                });
                
                // Add the "Add" button
                const addButton = document.createElement('div');
                addButton.id = 'add-link-btn';
                addButton.className = 'flex flex-col items-center space-y-2 cursor-pointer';
                addButton.innerHTML = `
                    <div class="w-14 h-14 bg-[var(--card-bg-color)] border-2 border-dashed border-[var(--border-color)] rounded-2xl flex items-center justify-center text-[var(--text-secondary-color)]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    </div>
                    <span class="text-xs text-[var(--text-secondary-color)]">Add</span>
                `;
                quickLinksGrid.appendChild(addButton);

                addEventListeners();
            }
            
            // --- SEARCH FUNCTIONALITY ---
            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const query = searchInput.value.trim();
                if (!query) return;

                // Check if it's a valid URL
                try {
                    new URL(query);
                    window.location.href = query;
                } catch (_) {
                    // Otherwise, perform a search
                    window.location.href = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
                }
            });

            // --- EVENT LISTENERS (Long Press, Clicks, etc.) ---
            function addEventListeners() {
                let longPressTimer;
                document.querySelectorAll('.quick-link-item').forEach(item => {
                    item.addEventListener('touchstart', (e) => {
                        e.preventDefault(); // Prevent navigation on touchstart
                        activeLinkIndex = item.dataset.index;
                        longPressTimer = setTimeout(() => {
                            showContextMenu(e.touches[0].clientX, e.touches[0].clientY);
                        }, 500);
                    });
                    item.addEventListener('touchend', (e) => {
                        clearTimeout(longPressTimer);
                        // If it's a short tap, navigate
                        if (e.changedTouches[0].target.closest('a') && activeLinkIndex !== null) {
                            const link = quickLinksData[activeLinkIndex];
                            if(link) window.location.href = link.url;
                        }
                    });
                    item.addEventListener('touchmove', () => clearTimeout(longPressTimer));
                    item.oncontextmenu = (e) => { // for desktop testing
                        e.preventDefault();
                        activeLinkIndex = item.dataset.index;
                        showContextMenu(e.clientX, e.clientY);
                    };
                });
                
                document.getElementById('add-link-btn').addEventListener('click', handleAddLink);
            }

            // --- CONTEXT MENU LOGIC ---
            function showContextMenu(x, y) {
                contextMenu.style.left = `${x}px`;
                contextMenu.style.top = `${y}px`;
                contextMenu.classList.remove('hidden');
                
                const menuRect = contextMenu.getBoundingClientRect();
                if (menuRect.right > window.innerWidth) {
                    contextMenu.style.left = `${window.innerWidth - menuRect.width - 10}px`;
                }
                if (menuRect.bottom > window.innerHeight) {
                    contextMenu.style.top = `${window.innerHeight - menuRect.height - 10}px`;
                }
            }
            
            window.addEventListener('click', () => contextMenu.classList.add('hidden'));
            
            document.getElementById('context-edit').addEventListener('click', (e) => {
                e.preventDefault();
                handleEditLink();
            });

            document.getElementById('context-remove').addEventListener('click', (e) => {
                e.preventDefault();
                handleRemoveLink();
            });
            
            // --- EDIT/ADD/REMOVE LOGIC ---
            function handleAddLink() {
                document.getElementById('modal-title').innerText = 'Add Link';
                editForm.reset();
                document.getElementById('edit-index').value = '';
                editModal.classList.remove('hidden');
            }

            function handleEditLink() {
                 if (activeLinkIndex === null) return;
                const linkData = quickLinksData[activeLinkIndex];
                document.getElementById('modal-title').innerText = 'Edit Link';
                document.getElementById('edit-index').value = activeLinkIndex;
                document.getElementById('edit-name').value = linkData.name;
                document.getElementById('edit-url').value = linkData.url;
                editModal.classList.remove('hidden');
            }

            function handleRemoveLink() {
                if (activeLinkIndex === null) return;
                quickLinksData.splice(activeLinkIndex, 1);
                saveAndRerender();
                activeLinkIndex = null;
            }

            document.getElementById('cancel-edit').addEventListener('click', () => {
                editModal.classList.add('hidden');
            });

            editForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const index = document.getElementById('edit-index').value;
                const name = document.getElementById('edit-name').value;
                const url = document.getElementById('edit-url').value;
                const icon = name.substring(0, 2).toUpperCase(); // Auto-generate icon from name

                const newLinkData = { name, url, icon, color: 'bg-gray-500' }; // Default color for new/edited links

                if (index) { // Editing existing link
                    quickLinksData[index] = { ...quickLinksData[index], ...newLinkData };
                } else { // Adding new link
                    quickLinksData.push(newLinkData);
                }
                
                saveAndRerender();
                editModal.classList.add('hidden');
            });
            
            function saveAndRerender() {
                saveQuickLinks();
                renderQuickLinks();
            }

            // --- INITIALIZATION ---
            loadQuickLinks();
        });
    </script>
</body>
</html>

